---
DEFINITIONS:

  METRICS_BASE:
    base: pyez_junos
    interface: interface
    device: device
    bgp: bgp
    igmp: igmp

  NETWORK_REGEXES:
    - "[gxe][et]-*/1/*"

  IGMP_NETWORKS:
    ignore:
      "239.195.255.255/32" : Senderliste
    allow:
      "239.192.0.0/16": GEMA
      "239.193.0.0/16": ProSiebenSat.1 MediaSE
      "239.194.0.0/16": RTL Gruppe
      "239.195.0.0/16": Andere
      "239.199.0.0/16": Lokale Streams

  OSPF_METRICS:
    Gauge:
      - metric: neighbor_state
        key: ospf_neighbor_state
        description: OSPF is (0(DOWN)/1(UP))
        function: is_ok

  OSPF_LABEL_WRAPPER:
    - label: neighbor
      key: neighbor_id
  NETWORK_METRICS:
    Gauge:
      - metric: last_flapped
        key: flapped
        type: seconds
        description: Port Date (Unix TimeStamp) for last flap

      - metric: is_running
        key: running
        description: Port is_up (0(DOWN)/1(UP))
        function: is_ok

      - metric: is_operational
        key: oper
        description: Port oper (0(DOWN)/1(UP))
        function: is_ok

      - metric: is_admin
        key: admin
        description: Port admin (0(DOWN)/1(UP))
        function: is_ok

      - metric: is_enabled
        key: present
        description: Port is_enabled (0(DOWN)/1(UP))
        function: is_ok

    # Optic Specific
      - metric: temperature
        key: module_temperature
        type: celsius
        description: Port SFP temperature

      - metric: sending_laser_fault_alarm
        key: tx_laser_fault_alarm
        description: Port tx laser fault alarm on sfp (0(FAULT)/1(OK))
        function: is_ok

      - metric: sending_optic_power
        key: tx_optic_power
        description: Sending Power on interface
        type: dbm
        function: floatify
  
      - metric: receiving_optic_power
        key: rx_optic_power
        description: Receiving Power on interface
        type: dbm
        function: floatify

      - metric: voltage
        key: module_voltage
        description: Port SFP voltage
        type: dbm

      - metric: laser_bias_current
        key: laser_bias_current
        description: Laser Bias Current
        type: dbm
    # Thresholds for alarms
    # temperature
      - metric: module_temperature_high_alarm_threshold
        key: module_temperature_high_alarm
        description: Threshold for alarms
        type: celsius

      - metric: module_temperature_low_alarm_threshold
        key: module_temperature_low_alarm
        description: Threshold for alarms
        type: celsius

      - metric: module_temperature_high_warn_threshold
        key: module_temperature_high_warn
        description: Threshold for alarms
        type: celsius

      - metric: module_temperature_low_warn_threshold
        key: module_temperature_low_warn
        description: Threshold for alarms
        type: celsius
    # receiving
      - metric: receiving_optic_power_high_alarm_threshold
        key: rx_optic_power_high_alarm
        description: Threshold for alarms
        type: dbm

      - metric: receiving_optic_power_low_alarm_threshold
        key: rx_optic_power_low_alarm
        description: Threshold for alarms
        type: dbm

      - metric: receiving_optic_power_high_warn_threshold
        key: rx_optic_power_high_warn
        description: Threshold for alarms
        type: dbm

      - metric: receiving_optic_power_low_warn_threshold
        key: rx_optic_power_low_warn
        description: Threshold for alarms
        type: dbm
    # sending
      - metric: sending_optic_power_high_alarm_threshold
        key: tx_optic_power_high_alarm
        description: Threshold for alarms
        type: dbm

      - metric: sending_optic_power_low_alarm_threshold
        key: tx_optic_power_low_alarm
        description: Threshold for alarms
        type: dbm

      - metric: sending_optic_power_high_warn_threshold
        key: tx_optic_power_high_warn
        description: Threshold for alarms
        type: dbm

      - metric: sending_optic_power_low_warn_threshold
        key: tx_optic_power_low_warn
        description: Threshold for alarms
        type: dbm
    # laser bias
      - metric: laser_bias_high_alarm_threshold
        key: laser_bias_high_alarm
        description: Threshold for alarms
        type: dbm

      - metric: laser_bias_low_alarm_threshold
        key: laser_bias_low_alarm
        description: Threshold for alarms
        type: dbm

      - metric: laser_bias_high_warn_threshold
        key: laser_bias_high_warn
        description: Threshold for alarms
        type: dbm

      - metric: laser_bias_low_warn_threshold
        key: laser_bias_low_warn
        description: Threshold for alarms
        type: dbm

    Counter:
      - metric: received
        key: rx_bytes
        description: Total received Bytes by Port
        type: bytes_total

      - metric: transmitted
        key: tx_bytes
        description: Total transmitted Bytes of Port
        type: bytes_total

    ## Error Counters
      - metric: transmit_error_output
        type: total
        key: input_errors
        description: Errors in transmitted packets

      - metric: receive_error_input
        type: total
        key: output_errors
        description: Errors in received packets

  NETWORK_LABEL_WRAPPER:
    - label: description
      key: description

    - label: MAC
      key: macaddr

    - label: speed
      key: speed

  ENVIRONMENT_METRICS:
    Gauge:
      - metric: uptime
        key: uptime
        description: Uptime of the host.
        type: seconds

      - metric: fan
        type: status
        key: Fans
        description: Fan STATUS (0(WRACKED)/1(OK))
        function: fan_power_temp_status
        specific: yes
      
      - metric: power
        type: status
        key: Power
        description: Power STATUS (0(WRACKED)/1(OK))
        function: fan_power_temp_status
        specific: yes
  
      - metric: temp
        type: status
        key: Temp
        description: Temperature Sensor STATUS (0(WRACKED)/1(OK))
        function: fan_power_temp_status
        specific: yes

      - metric: temp
        type: celsius
        key: Temp
        description: Temperature Sensor Value in celsius
        function: temp_celsius
        specific: yes

      - metric: reboot
        type: status
        key: RE0
        description: Last Reboot REASON (0(WRACKED)/1(OK))
        function: reboot
        specific: yes
      
      - metric: cpu_usage
        type: ratio
        key: re_loads
        description: Current CPU Load Ratio in percent
        function: cpu_usage
        specific: yes
      
      - metric: cpu_idle
        type: ratio
        key: re_loads
        description: Current CPU Idle Ratio in percent
        function: cpu_idle
        specific: yes

      - metric: ram
        type: bytes
        key: re_loads
        description: Current Memory Usage in bytes
        function: ram_usage
        specific: yes

      - metric: ram
        type: bytes_total
        key: re_loads
        description: Available Memory in bytes
        function: ram
        specific: yes

  ENVIRONMENT_LABEL_WRAPPER:
    - label: software_version
      key: version
  
    - label: hardware_model
      key: model

    - label: personality
      key: personality
  
  BGP_METRICS:
    Counter:
      - metric: prefixes_received
        type: total
        key: pfx_rx
        description: Received Prefixes from Peer
    Gauge:
      - metric: is_up
        type: status
        key: peerstate
        description: BGP Session is established (0(DOWN)/1(UP))
        function: is_ok

  BGP_LABEL_WRAPPER:
    - label: peername
      key: peername
